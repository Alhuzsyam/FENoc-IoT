{"ast":null,"code":"import { Chart, registerables } from 'chart.js';\nimport { interval } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class ChartComponent {\n  constructor(http) {\n    this.http = http;\n    this.apiUrl = 'http://localhost:8000/api/posts';\n  }\n  ngOnInit() {\n    Chart.register(...registerables); // Daftarkan semua modul Chart.js yang diperlukan\n    // Inisialisasi chart\n    this.chart = new Chart(\"myChart\", {\n      type: 'line',\n      data: {\n        labels: [],\n        datasets: [{\n          label: 'Kwh Today',\n          data: [],\n          borderColor: 'rgba(54, 162, 235, 1)',\n          backgroundColor: 'rgba(54, 162, 235, 0.2)',\n          borderWidth: 2,\n          tension: 0.1,\n          fill: false,\n          pointRadius: 0,\n          borderDash: [5, 5]\n        }, {\n          label: 'Kwh Last',\n          data: [],\n          borderColor: 'rgba(255, 99, 132, 1)',\n          backgroundColor: 'rgba(255, 99, 132, 0.2)',\n          borderWidth: 2,\n          tension: 0.1,\n          fill: false,\n          pointRadius: 0,\n          borderDash: [5, 5]\n        }, {\n          label: 'Kvarh',\n          data: [],\n          borderColor: 'rgba(75, 192, 192, 1)',\n          backgroundColor: 'rgba(75, 192, 192, 0.2)',\n          borderWidth: 2,\n          tension: 0.1,\n          fill: false,\n          pointRadius: 0,\n          borderDash: [5, 5]\n        }, {\n          label: 'T-L',\n          data: [],\n          borderColor: 'rgba(153, 102, 255, 1)',\n          backgroundColor: 'rgba(153, 102, 255, 0.2)',\n          borderWidth: 2,\n          tension: 0.1,\n          fill: false,\n          pointRadius: 0,\n          borderDash: [5, 5]\n        }]\n      },\n      options: {\n        scales: {\n          y: {\n            beginAtZero: true\n          }\n        },\n        elements: {\n          line: {\n            tension: 0.4 // Tambahkan ketegangan garis untuk membuatnya lebih mulus\n          }\n        }\n      }\n    });\n    // Panggil fungsi fetchData pertama kali\n    this.fetchData();\n    // Set interval untuk refresh data setiap 60 detik\n    interval(5000).subscribe(() => this.fetchData());\n  }\n  fetchData() {\n    this.http.get(this.apiUrl).subscribe(data => {\n      console.log('Data from API:', data); // Tambahkan log untuk memeriksa data API\n      // Buat labels dari created_at atau gunakan timestamp yang sesuai\n      const labels = data.map(entry => new Date(entry.created_at).toLocaleTimeString());\n      // Format data sesuai dengan yang diharapkan oleh chart\n      const kwhToday = data.map(entry => parseFloat(entry.kwh_today));\n      const kwhLast = data.map(entry => parseFloat(entry.kwh_last));\n      const kvarh = data.map(entry => parseFloat(entry.kvarh));\n      const tl = data.map(entry => parseFloat(entry.tl));\n      console.log('Kwh Today Data:', kwhToday);\n      console.log('Kwh Last Data:', kwhLast);\n      console.log('Kvarh Data:', kvarh);\n      console.log('T-L Data:', tl);\n      // Update labels dan data chart\n      this.chart.data.labels = labels;\n      this.chart.data.datasets[0].data = kwhToday;\n      this.chart.data.datasets[1].data = kwhLast;\n      this.chart.data.datasets[2].data = kvarh;\n      this.chart.data.datasets[3].data = tl;\n      // Update chart\n      this.chart.update();\n    });\n  }\n  static #_ = this.ɵfac = function ChartComponent_Factory(t) {\n    return new (t || ChartComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ChartComponent,\n    selectors: [[\"app-chart\"]],\n    decls: 1,\n    vars: 0,\n    consts: [[\"id\", \"myChart\"]],\n    template: function ChartComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"canvas\", 0);\n      }\n    },\n    styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["Chart","registerables","interval","ChartComponent","constructor","http","apiUrl","ngOnInit","register","chart","type","data","labels","datasets","label","borderColor","backgroundColor","borderWidth","tension","fill","pointRadius","borderDash","options","scales","y","beginAtZero","elements","line","fetchData","subscribe","get","console","log","map","entry","Date","created_at","toLocaleTimeString","kwhToday","parseFloat","kwh_today","kwhLast","kwh_last","kvarh","tl","update","_","i0","ɵɵdirectiveInject","i1","HttpClient","_2","selectors","decls","vars","consts","template","ChartComponent_Template","rf","ctx","ɵɵelement"],"sources":["/Users/alhuzwiri/Documents/lab/Web/iot/nocproj/src/app/chart/chart.component.ts","/Users/alhuzwiri/Documents/lab/Web/iot/nocproj/src/app/chart/chart.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Chart, registerables } from 'chart.js';\nimport { HttpClient } from '@angular/common/http';\nimport { interval } from 'rxjs';\n\n@Component({\n  selector: 'app-chart',\n  templateUrl: './chart.component.html',\n  styleUrls: ['./chart.component.css']\n})\nexport class ChartComponent implements OnInit {\n  private apiUrl = 'http://localhost:8000/api/posts';\n  private chart: any;\n\n  constructor(private http: HttpClient) { }\n\n  ngOnInit(): void {\n    Chart.register(...registerables); // Daftarkan semua modul Chart.js yang diperlukan\n\n    // Inisialisasi chart\n    this.chart = new Chart(\"myChart\", {\n      type: 'line', // Ubah tipe chart menjadi 'line'\n      data: {\n        labels: [], // Labels akan diisi berdasarkan waktu atau data yang relevan\n        datasets: [\n          {\n            label: 'Kwh Today',\n            data: [], // Data awal kosong, akan diisi dari API\n            borderColor: 'rgba(54, 162, 235, 1)',\n            backgroundColor: 'rgba(54, 162, 235, 0.2)',\n            borderWidth: 2,\n            tension: 0.1,\n            fill: false,\n            pointRadius: 0,\n            borderDash: [5, 5],\n          },\n          {\n            label: 'Kwh Last',\n            data: [], // Data awal kosong, akan diisi dari API\n            borderColor: 'rgba(255, 99, 132, 1)',\n            backgroundColor: 'rgba(255, 99, 132, 0.2)',\n            borderWidth: 2,\n            tension: 0.1,\n            fill: false,\n            pointRadius: 0,\n            borderDash: [5, 5],\n          },\n          {\n            label: 'Kvarh',\n            data: [], // Data awal kosong, akan diisi dari API\n            borderColor: 'rgba(75, 192, 192, 1)',\n            backgroundColor: 'rgba(75, 192, 192, 0.2)',\n            borderWidth: 2,\n            tension: 0.1,\n            fill: false,\n            pointRadius: 0,\n            borderDash: [5, 5],\n          },\n          {\n            label: 'T-L',\n            data: [], // Data awal kosong, akan diisi dari API\n            borderColor: 'rgba(153, 102, 255, 1)',\n            backgroundColor: 'rgba(153, 102, 255, 0.2)',\n            borderWidth: 2,\n            tension: 0.1,\n            fill: false,\n            pointRadius: 0,\n            borderDash: [5, 5],\n          }\n        ]\n      },\n      options: {\n        scales: {\n          y: {\n            beginAtZero: true\n          }\n        },\n        elements: {\n          line: {\n            tension: 0.4 // Tambahkan ketegangan garis untuk membuatnya lebih mulus\n          }\n        }\n      }\n    });\n\n    // Panggil fungsi fetchData pertama kali\n    this.fetchData();\n\n    // Set interval untuk refresh data setiap 60 detik\n    interval(5000).subscribe(() => this.fetchData());\n  }\n\n  fetchData(): void {\n    this.http.get<any>(this.apiUrl).subscribe(data => {\n      console.log('Data from API:', data); // Tambahkan log untuk memeriksa data API\n\n      // Buat labels dari created_at atau gunakan timestamp yang sesuai\n      const labels = data.map((entry: any) => new Date(entry.created_at).toLocaleTimeString());\n\n      // Format data sesuai dengan yang diharapkan oleh chart\n      const kwhToday = data.map((entry: any) => parseFloat(entry.kwh_today));\n      const kwhLast = data.map((entry: any) => parseFloat(entry.kwh_last));\n      const kvarh = data.map((entry: any) => parseFloat(entry.kvarh));\n      const tl = data.map((entry: any) => parseFloat(entry.tl));\n\n      console.log('Kwh Today Data:', kwhToday);\n      console.log('Kwh Last Data:', kwhLast);\n      console.log('Kvarh Data:', kvarh);\n      console.log('T-L Data:', tl);\n\n      // Update labels dan data chart\n      this.chart.data.labels = labels;\n      this.chart.data.datasets[0].data = kwhToday;\n      this.chart.data.datasets[1].data = kwhLast;\n      this.chart.data.datasets[2].data = kvarh;\n      this.chart.data.datasets[3].data = tl;\n\n      // Update chart\n      this.chart.update();\n    });\n  }\n}\n","\n    <canvas id=\"myChart\">\n        \n    </canvas>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}